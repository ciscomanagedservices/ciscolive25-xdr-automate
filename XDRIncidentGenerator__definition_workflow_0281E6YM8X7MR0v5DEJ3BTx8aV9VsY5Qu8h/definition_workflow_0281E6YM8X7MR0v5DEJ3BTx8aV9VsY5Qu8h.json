{
  "workflow": {
    "unique_name": "definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h",
    "name": "CL Amsterdam XDR Incident Generator",
    "title": "CL Amsterdam XDR Incident Generator",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "input",
          "name": "quarantine_bool",
          "type": "datatype.boolean",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02EK8TM5EYES17VWuLyPNzJJkLVtyyG2c8R",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "input",
          "name": "ransom_bool",
          "type": "datatype.boolean",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02EJGUEOUXPUF1eYTu8Qh4khvnz4oISBryu",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "input",
          "name": "malfile_bool",
          "type": "datatype.boolean",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02EK9DGD8NSB11oqc4UrWlO3KBxwfqPLn98",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1,
          "scope": "local",
          "name": "current_iteration",
          "type": "datatype.integer",
          "description": "Tracks current Incident being generated",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_0284VFW8EF7D20XxyzK5UyQCzh1r8tBdSvv",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": true,
          "scope": "input",
          "name": "cnc_bool",
          "type": "datatype.boolean",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02DIWZG4DO1E94SPsoFWkNCkrItrF6QDIJG",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Original:\n'The affected endpoint `npi-greycon-p-3.npi.corp` with IP address `10.96.65.199` is active and runs on Windows Server 2019 Standard (Build 17763.3650). Secure Endpoint connector version `8.2.3.30119` is installed on the endpoint. The endpoint has been flagged with a risk score of 100. An event related to an outgoing TCP connection to an external IP `51.116.246.106` on port 443 was recorded at the same time as the malware detection event, suggesting a potential command and control (C2) communication attempt.\n\n\nAct as an escalation level IT Security Operations investigator AI Agent. Generate a more thorough and enhanced Technical Summary section of the security review document in markdown format.  The document is about the security incident, NOT the AI agent collecting data.   Do not include run_id .AI Agent generated document: The affected endpoint `npi-greycon-p-3.npi.corp` with IP address `10.96.65.199` is active and runs on Windows Server 2019 Standard (Build 17763.3650). Secure Endpoint connector version `8.2.3.30119` is installed on the endpoint. The endpoint has been flagged with a risk score of 100. An event related to an outgoing TCP connection to an external IP `51.116.246.106` on port 443 was recorded at the same time as the malware detection event, suggesting a potential command and control (C2) communication attempt. AI Agent Message History:[{'role': 'system', 'content': 'Act as a IT Security Operations investigator.  Use the available agents and tools to investigate the security event using SANS incident response methodology. Your job is to update a security incident review document, ONE section at a time after gathering information.  Sections will include:  'Executive Summary', 'Technical Summary', 'Supporting Evidence', and 'Recommended Mitigations'.  ALWAYS send a plan of action on your FIRST response with a detailed plan, before doing any investigation. Take your time.  Once you have completed updating the document sections as much as possible, send a final response and reply with FINAL ANSWER: in your text response.   ALWAYS include as much detailed technical output from Cisco Security tools such as API responses as possible technical updates to prove your analysis and next steps.  Do NOT take any response actions, only document in recommended mitigations what should be done.  If you get a 404 to a tool call, you may refactor the path and try again before concluding the investigation as you may be going to an invalid path.nn---n Under no circumstances should you attempt to call functions / tools that are not available to you.n Any functions / tools you do call must have the name satisfy the following regex: ^[a-zA-Z0-9_-]{1,64}$n---'}, {'role': 'user', 'content': 'You are assigned to the following incident:nnrun_id: 02EF877HMHHAW5ZOXLZHWYeWKdwkW8TyQEKnEvent: n {'date':'2024-05-17 19:51:27 UTC','file_path':'?C:Program Files (x86)Common FilesGreycon SharedCopy ControlGreycon.CopyControl.Wizard.exe','url_referer':'','mitre_tactics':'','z_product':'amp','command_line_args':'','action':'detect','conn_guid':'c49d680d-7dbe-4f3c-ad82-7a580e3702c7','id':'7370058597402673000','tag':'malware','src_data':'','parent_file_disposition':'Unknown','domains':'','event_title':'Malware Detected - Gen:Variant.MSILHeracles.111226','src_host':'npi-greycon-p-3.npi.corp','mitre_techniques':'','ips':'','z_event_sent':'0','parent_file_name':'explorer.exe','descr':'Threat Detected','domain':'','files':'','parent_file_hash':'9e3bd0da2531cdfe3499c82c729b74fa9e49ab2397ca37fcd3d93d650c812ddd','sources':'','signature':'Gen:Variant.MSILHeracles.111226','z_search_name':'cisco_mdr_malware_detect','dst_ip':'','content':'','src_ip':'10.96.65.199','console_link':'https://console.amp.cisco.com/computers/c49d680d-7dbe-4f3c-ad82-7a580e3702c7/trajectory2','archive_file_hash':'','z_orig_index':'3595333eaceb8a65efc4bb9b6c2ac53f_mdr','z_previous_ticket':'','_time':'2024-05-17T20:00:40.000+00:00','user_agent':'','severity':'Medium','detection':'Gen:Variant.MSILHeracles.111226','z_splunk_link':'https://cmsmdr-cxcloud.cisco.com/en-US/app/cms_mdr_gsoc/search?q=search%20index=3595333eaceb8a65efc4bb9b6c2ac53f_mdr%20sourcetype=cisco:amp:event%20detection_id=%227370058593107705857%22%20earliest=1715975367%20latest=1715975607','file_disposition':'Unknown','z_suppression':'npi-greycon-p-3.npi.corp:862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f','file_name':'Greycon.CopyControl.Wizard.exe','z_event_confirm':'0','url':'','record_type':'','use_case':'mdr_malware','file_hash':'862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f','category':'Threat Detected','z_event_id':'8134b765c7b13236d3726a6c89081f02','user':'N11159@NPI','customer':'nenah'}'}, {'content': 'To investigate this security incident, I will follow the SANS incident response methodology and update the security incident review document accordingly. Here is the plan of action:nn1. **Preparation**: Review the event details provided and identify the necessary tools (Cisco Secure Endpoint API, Cisco Umbrella Investigate API) that will be used for gathering additional information.nn2. **Identification**: Use the Cisco Secure Endpoint API and Cisco Umbrella Investigate API to collect more data on the identified malware (Gen:Variant.MSILHeracles.111226) and its behavior, as well as any related indicators of compromise (IOCs) such as the file hash.nn3. **Containment**: While I will not be performing any containment actions myself, I will gather enough information to recommend appropriate containment strategies in the 'Recommended Mitigations' section of the document.nn4. **Eradication and Recovery**: Although these steps will be carried out by the response team, I will provide insights and recommendations based on the gathered information.nn5. **Lessons Learned**: Analyze the incident to understand how the malware might have entered the system, its impact, and how similar incidents can be prevented in the future.nnI'll now proceed with the investigation by using the Cisco Secure Endpoint API to retrieve more information about the detected malware and its trajectory on the affected endpoint, as well as the Cisco Umbrella Investigate API to check the reputation of any domains or IPs associated with the malware.nnUsing the information about the event given above, I will make API calls to:nn- Cisco Secure Endpoint to gather more details about the endpoint (c49d680d-7dbe-4f3c-ad82-7a580e3702c7) and the file (Greycon.CopyControl.Wizard.exe) as well as its hash (862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f).n- Cisco Umbrella Investigate to check the domain reputation related to the event if applicable.nnI will initiate the API calls now.', 'role': 'assistant', 'tool_calls': [{'id': 'call_yChZ1hZSwtPxUWVLklBoADsY', 'function': {'arguments': '{'i_customer': 'nenah', 'i_request_payload': '', 'i_request_parameters': '', 'i_auth_blob': '', 'i_http_method': 'GET', 'i_relative_path': '/computers/c49d680d-7dbe-4f3c-ad82-7a580e3702c7/trajectory'}', 'name': '02EE5M4RK91FZ3OPijvPvMShV7bS493eeu8'}, 'type': 'function'}, {'id': 'call_WLhJRvMpi46jyFNwW5JRjEa3', 'function': {'arguments': '{'i_customer': 'nenah', 'i_request_payload': '', 'i_request_parameters': '?q=862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f', 'i_auth_blob': '', 'i_http_method': 'GET', 'i_relative_path': '/events'}', 'name': '02EE5M4RK91FZ3OPijvPvMShV7bS493eeu8'}, 'type': 'function'}]}, {'role': 'tool', 'tool_call_id': 'call_yChZ1hZSwtPxUWVLklBoADsY', 'content': 'ERROR: Can only return up to 16000 characters. output was 414801 characters. Limit query API call by parameters such as limit, start_date, end_date!'}, {'role': 'tool', 'tool_call_id': 'call_WLhJRvMpi46jyFNwW5JRjEa3', 'content': 'action execution  errored for type web-service.http_request err:code:400 message::{'version':null,'metadata':{'links':{'self':'https://api.amp.cisco.com/v1/events?q=862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f'}},'data':{},'errors':[{'error_code':400,'description':'Bad Request','details':['Following query parameter(s) are invalid: q']}]}'}, {'content': '', 'role': 'assistant', 'tool_calls': [{'id': 'call_lhhnToK5u78wAS43hDU8GzPb', 'function': {'arguments': '{'i_customer': 'nenah', 'i_request_payload': '', 'i_request_parameters': '?limit=20\u0026start_date=2024-05-17T19:00:00Z', 'i_auth_blob': '', 'i_http_method': 'GET', 'i_relative_path': '/events'}', 'name': '02EE5M4RK91FZ3OPijvPvMShV7bS493eeu8'}, 'type': 'function'}, {'id': 'call_mmtv4TcIR96nzGZEpzWN5ppm', 'function': {'arguments': '{'i_customer': 'nenah', 'i_request_payload': '', 'i_request_parameters': '?q=862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f', 'i_auth_blob': '', 'i_http_method': 'GET', 'i_relative_path': '/computers/activity'}', 'name': '02EE5M4RK91FZ3OPijvPvMShV7bS493eeu8'}, 'type': 'function'}]}, {'role': 'tool', 'tool_call_id': 'call_lhhnToK5u78wAS43hDU8GzPb', 'content': 'ERROR: Can only return up to 16000 characters. output was 20022 characters. Limit query API call by parameters such as limit, start_date, end_date!'}, {'role': 'tool', 'tool_call_id': 'call_mmtv4TcIR96nzGZEpzWN5ppm', 'content': '{'version':'v1.2.0','metadata':{'links':{'self':'https://api.amp.cisco.com/v1/computers/activity?q=862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f'},'results':{'total':1,'current_item_count':1,'index':0,'items_per_page':500}},'data':[{'connector_guid':'c49d680d-7dbe-4f3c-ad82-7a580e3702c7','hostname':'npi-greycon-p-3.npi.corp','windows_processor_id':'0f8bfbff00000650','active':true,'links':{'computer':'https://api.amp.cisco.com/v1/computers/c49d680d-7dbe-4f3c-ad82-7a580e3702c7','trajectory':'https://api.amp.cisco.com/v1/computers/c49d680d-7dbe-4f3c-ad82-7a580e3702c7/trajectory?q=862f74d1f4f0a76e5b21d8c49cb7d15a5dbcbdb3975734d5b78f525571f8ed5f','group':'https://api.amp.cisco.com/v1/groups/e302d446-ed03-4815-9285-4ff446b3d4b9'}}]}'}, {'content': '', 'role': 'assistant', 'tool_calls': [{'id': 'call_PjeZW7T3OQBTGbgS3CaMq7R4', 'function': {'arguments': '{'i_customer': 'nenah', 'i_request_payload': '', 'i_request_parameters': '?limit=1\u0026start_date=2024-05-17T19:00:00Z', 'i_auth_blob': '', 'i_http_method': 'GET', 'i_relative_path': '/events'}', 'name': '02EE5M4RK91FZ3OPijvPvMShV7bS493eeu8'}, 'type': 'function'}, {'id': 'call_dlbUvuoCQwFWeZliPhPuw9xD', 'function': {'arguments': '{'i_customer': 'nenah', 'i_request_payload': '', 'i_request_parameters': '?limit=1', 'i_auth_blob': '', 'i_http_method': 'GET', 'i_relative_path': '/computers/c49d680d-7dbe-4f3c-ad82-7a580e3702c7/trajectory'}', 'name': '02EE5M4RK91FZ3OPijvPvMShV7bS493eeu8'}, 'type': 'function'}]}, {'role': 'tool', 'tool_call_id': 'call_PjeZW7T3OQBTGbgS3CaMq7R4', 'content': '{  ' version  ' :  ' v1 . 2.0  ' ,  ' metadata  ' : {  ' links  ' : {  ' self  ' :  ' https : / / api . amp . cisco . com / v1 / events ? limit = 1  u0026start_date = 2024 - 05 - 17T19 : 00 : 00Z  ' ,  ' next  ' :  ' https : / / api . amp . cisco . com / v1 / events ? limit = 1  u0026start_date = 2024 - 05 - 17T19 % 3A00 % 3A00Z  u0026offset = 1  ' } ,  ' results  ' : {  ' total  ' : 1146 ,  ' current_item_count  ' : 1 ,  ' index  ' : 0 ,  ' items_per_page  ' : 1 } } ,  ' data  ' : [ {  ' id  ' : 1583906187 ,  ' timestamp  ' : 1715976714 ,  ' timestamp_nanoseconds  ' : 643625400 ,  ' date  ' :  ' 2024 - 05 - 17T20 : 11 : 54 + 00 : 00  ' ,  ' event_type  ' :  ' Product Update Failed  ' ,  ' event_type_id  ' : 553648137 ,  ' connector_guid  ' :  ' f06b28bd - ebde - 4118 - b9eb - da2a4c52e3e1  ' ,  ' group_guids  ' : [  ' 9981fd2a - 38b4 - 45be - 99f3 - 99dcc4e46a37  ' ,  ' 8dce873c - 2d68 - 48b9 - 8de7 - fab7cfe592d4  ' ] ,  ' error  ' : {  ' error_code  ' : 16019 ,  ' description  ' :  ' Unable to verify Secure Endpoint's digital signature . Please update Windows .  ' } ,  ' computer  ' : {  ' connector_guid  ' :  ' f06b28bd - ebde - 4118 - b9eb - da2a4c52e3e1  ' ,  ' hostname  ' :  ' P2120653 . swmintl . com  ' ,  ' external_ip  ' :  ' 165.225 . 20.237  ' ,  ' active  ' : true ,  ' network_addresses  ' : [ {  ' ip  ' :  ' 172.20 . 13.44  ' ,  ' mac  ' :  ' 18 : 03 : 73 : 41 : 96 : 4a  ' } ] ,  ' links  ' : {  ' computer  ' :  ' https : / / api . amp . cisco . com / v1 / computers / f06b28bd - ebde - 4118 - b9eb - da2a4c52e3e1  ' ,  ' trajectory  ' :  ' https : / / api .nn\u003c\u003c\u003c\u003c Processed tool output trimmed due to excessive length to reduce prompt tokens. If complete output required, rerun tool, then summarize output in following message \u003e\u003e\u003e\u003e'}, {'role': 'tool', 'tool_call_id': 'call_dlbUvuoCQwFWeZliPhPuw9xD', 'content': '{  ' version  ' :  ' v1 . 2.0  ' ,  ' metadata  ' : {  ' links  ' : {  ' self  ' :  ' https : / / api . amp . cisco . com / v1 / computers / c49d680d - 7dbe - 4f3c - ad82 - 7a580e3702c7 / trajectory ? limit = 1  ' } } ,  ' data  ' : {  ' computer  ' : {  ' connector_guid  ' :  ' c49d680d - 7dbe - 4f3c - ad82 - 7a580e3702c7  ' ,  ' hostname  ' :  ' npi - greycon - p - 3 . npi . corp  ' ,  ' windows_processor_id  ' :  ' 0f8bfbff00000650  ' ,  ' active  ' : true ,  ' links  ' : {  ' computer  ' :  ' https : / / api . amp . cisco . com / v1 / computers / c49d680d - 7dbe - 4f3c - ad82 - 7a580e3702c7  ' ,  ' trajectory  ' :  ' https : / / api . amp . cisco . com / v1 / computers / c49d680d - 7dbe - 4f3c - ad82 - 7a580e3702c7 / trajectory  ' ,  ' group  ' :  ' https : / / api . amp . cisco . com / v1 / groups / e302d446 - ed03 - 4815 - 9285 - 4ff446b3d4b9  ' } ,  ' operating_system  ' :  ' Windows Server 2019 Standard ( Build 17763.3650 )  ' ,  ' os_version  ' :  ' 10.0 . 17763.3650  ' ,  ' internal_ips  ' : [  ' 10.96 . 65.199  ' ] ,  ' external_ip  ' :  ' 63.128 . 96.1  ' ,  ' flag  ' : false ,  ' id  ' : 55859216 ,  ' install_date  ' :  ' 2022 - 09 - 07T19 : 58 : 02Z  ' ,  ' is_compromised  ' : true ,  ' demo  ' : false ,  ' windows_machine_guid  ' :  ' 51bfe281 - 5eb8 - 47b2 - a055 - a60ce813b8ad  ' ,  ' os_type  ' :  ' WinOs  ' ,  ' supports  ' : {  ' device_trajectory  ' : true ,  ' events  ' : true ,  ' move_to_group  ' : true ,  ' request_snapshot  ' : true ,  ' scan  ' : true ,  ' orbital  ' : {  ' is_supported  ' : true ,  ' agent_active  ' : true ,  ' agent_nil_state  ' : false ,  ' agent_supported  ' : true ,nn\u003c\u003c\u003c\u003c Processed tool output trimmed due to excessive length to reduce prompt tokens. If complete output required, rerun tool, then summarize output in following message \u003e\u003e\u003e\u003e'}, {'content': 'Based on the results received from the API calls, I will now update the various sections of the security incident review document.nnStarting with the 'Technical Summary', I will include details from the Secure Endpoint response, indicating that the affected endpoint (npi-greycon-p-3.npi.corp, IP address 10.96.65.199) is active, runs Windows Server 2019 Standard, has the Secure Endpoint connector version 8.2.3.30119 installed, and has a risk score of 100. Additionally, an event related to an outgoing TCP connection to an external IP (51.116.246.106, port 443) was recorded at the same time as the malware detection event, which may suggest possible command and control (C2) communication.nnThis will be followed by an update to the 'Supporting Evidence' section to include the specific API call responses and the details of the detected malware, including its hash and its possible network behavior.nnNext, I will provide 'Recommended Mitigations' based on the information gathered, advising on further analysis of the event details, scrutinizing the network traffic to the suspicious IP address for additional context, and recommending the application of appropriate security measures such as network segmentation and endpoint isolation until the threat is fully understood and neutralized.nnLet's proceed to update the document:nn1. Update the 'Technical Summary' with the endpoint details and observed network behavior.n2. Update the 'Supporting Evidence' with API call responses and malware detection specifics.n3. Add 'Recommended Mitigations' based on the collected information.nnI will start by updating the 'Technical Summary' section.', 'role': 'assistant', 'tool_calls': [{'id': 'call_DxlOEq7OoPF2a9F3zfgz6nhs', 'function': {'arguments': '{'i_message':'Updating the 'Technical Summary' section with endpoint details and observed network behavior.','i_section':'Technical Summary','i_run_id':'02EF877HMHHAW5ZOXLZHWYeWKdwkW8TyQEK','i_section_content':'The affected endpoint `npi-greycon-p-3.npi.corp` with IP address `10.96.65.199` is active and runs on Windows Server 2019 Standard (Build 17763.3650). Secure Endpoint connector version `8.2.3.30119` is installed on the endpoint. The endpoint has been flagged with a risk score of 100. An event related to an outgoing TCP connection to an external IP `51.116.246.106` on port 443 was recorded at the same time as the malware detection event, suggesting a potential command and control (C2) communication attempt.','i_z_event_id':'8134b765c7b13236d3726a6c89081f02'}', 'name': '02EE5M77AOBOH5T28RNGmaTe2rEXu2bOi6i'}, 'type': 'function'}]}, {'role': 'tool', 'tool_call_id': 'call_DxlOEq7OoPF2a9F3zfgz6nhs', 'content': 'true'}]\n\n\npath(\"generative_topology_demo/\", include(\"demos.generative_topology.urls\")),\npath(\"sac_ai_demo/\", include(\"demos.sac_ai.urls\")),\npath(\"service_risk_demo/\", include(\"demos.service_risk.urls\")),\npath(\"sac_tv_ai_demo/\", include(\"demos.sac_tv_ai.urls\")),\n\n\n\nimport json\nmessage_format=     [\n{\n\"role\": \"system\",\n\"content\": \"Act as an escalation level IT Security Operations investigator AI Agent. Generate a more thorough and enhanced [$workflow.02DJM$workflow.02DJM7JEGK54E1PyA107NajR1I7Ue45Hupt.input.02DJM8SXQ2ZE24YwOq6A0OqDxVwlZDXnhcL$security review document in markdown format.  The document is about the security incident, NOT the AI agent collecting data.   Do not include run_id.\"\n},\n{\n\"role\": \"user\",\n\"content\": f\"Generated section content:  blah blah blah\\n\\nMessage History:{l_messages}\"\n}\n]\n\noutput_json = json.dumps(message_format)\n\n\n\n{\n\"source\": [\n\"Secure Endpoint\",\n\"Umbrella\",\n\"CrowdStrike Falcon\",\n\"Cisco XDR Analytics\"\n],\n\"tlp\": [\n\"white\",\n\"green\",\n\"amber\",\n\"red\"\n],\n\"confidence\": [\n\"None\",\n\"Unknown\",\n\"Info\",\n\"Low\",\n\"Medium\",\n\"High\"\n],\n\"severity\": [\n\"None\",\n\"Unknown\",\n\"Info\",\n\"Low\",\n\"Medium\",\n\"High\",\n\"Critical\"\n],\n\"tactics\": [\n\"TA0001\",\n\"TA0002\",\n\"TA0003\",\n\"TA0004\",\n\"TA0005\",\n\"TA0006\",\n\"TA0007\",\n\"TA0008\",\n\"TA0009\",\n\"TA0010\",\n\"TA0011\",\n\"TA0040\",\n\"TA0042\",\n\"TA0043\"\n],\n\"techniques\": [\n\"T1001\",\n\"T1022\",\n\"T1041\",\n\"T1056.001\",\n\"T1059.005\",\n\"T1071.001\",\n\"T1113\",\n\"T1204.002\",\n\"T1204.003\",\n\"T1219\",\n\"T1566.002\",\n\"T1567\",\n\"T1586.002\",\n\"T1588.001\",\n\"T1589\",\n\"T1591\",\n\"T1598.002\",\n\"T1095\"\n],\n\"targets\": [\n{\n\"type\": \"endpoint\",\n\"observables\": [\n{\n\"value\": \"192.168.66.238\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"commando.skynet.lab\",\n\"type\": \"hostname\"\n}\n]\n},\n{\n\"type\": \"endpoint\",\n\"observables\": [\n{\n\"value\": \"victim-win-7\",\n\"type\": \"hostname\"\n},\n{\n\"value\": \"10.0.1.27\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"4.150.2.39\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"00:0d:3a:75:fe:22\",\n\"type\": \"mac_address\"\n},\n{\n\"value\": \"0000-0001-3426-5385-0515-5562-94\",\n\"type\": \"serial_number\"\n},\n{\n\"value\": \"536864\",\n\"type\": \"swc_device_id\"\n}\n]\n},\n{\n\"type\": \"device\",\n\"observables\": [\n{\n\"value\": \"8fba9262-2e9c-4abc-bb64-a9cde8e49595\",\n\"type\": \"cisco_uc_id\"\n},\n{\n\"value\": \"victim-win-0\",\n\"type\": \"hostname\"\n},\n{\n\"value\": \"10.0.1.20\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"20.114.75.234\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"fe80::3395:3ae7:7e59:d31a\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"00:22:48:ab:dc:c1\",\n\"type\": \"mac_address\"\n},\n{\n\"value\": \"0000-0017-4382-5675-6873-9709-06\",\n\"type\": \"serial_number\"\n},\n{\n\"value\": \"536857\",\n\"type\": \"swc_device_id\"\n},\n{\n\"value\": \"azureuser\",\n\"type\": \"user\"\n}\n]\n},\n{\n\"type\": \"endpoint\",\n\"observables\": [\n{\n\"value\": \"ded0a658-104f-4805-8544-6b3d1715fee6\",\n\"type\": \"amp_computer_guid\"\n},\n{\n\"value\": \"victim-win-6.org1.net\",\n\"type\": \"hostname\"\n},\n{\n\"value\": \"10.0.1.26\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"20.114.75.234\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"0000000000000000\",\n\"type\": \"processor_id\"\n}\n]\n},\n{\n\"type\": \"endpoint.workstation\",\n\"observables\": [\n{\n\"value\": \"6a68de063b7040beb3977f2a856d9b5d\",\n\"type\": \"crowdstrike_id\"\n},\n{\n\"value\": \"desktop-913aimj\",\n\"type\": \"hostname\"\n},\n{\n\"value\": \"192.168.106.79\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"00-50-56-a9-cc-bc\",\n\"type\": \"mac_address\"\n}\n]\n},\n{\n\"type\": \"endpoint\",\n\"observables\": [\n{\n\"value\": \"85049545-d224-46d3-9f51-658e8ff39fad\",\n\"type\": \"amp_computer_guid\"\n},\n{\n\"value\": \"victim-win-2.org1.net\",\n\"type\": \"hostname\"\n},\n{\n\"value\": \"10.0.1.22\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"20.114.75.234\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"0000000000000000\",\n\"type\": \"processor_id\"\n}\n]\n},\n{\n\"type\": \"endpoint.workstation\",\n\"observables\": [\n{\n\"value\": \"LOXX-WIN10VIC02\",\n\"type\": \"hostname\"\n},\n{\n\"value\": \"10.1.82.152\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"00-50-56-a1-dd-ba\",\n\"type\": \"mac_address\"\n},\n{\n\"value\": \"77c4ad249ca04237ac36ad3c9071e3b9\",\n\"type\": \"crowdstrike_id\"\n}\n]\n}\n],\n\"observables\": [\n{\n\"value\": \"b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"add683a6910abbbf0e28b557fad0ba998166394932ae2aca069d9aa19ea8fe88\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"e9c5a42bdcca52bd24b095eae55dbc5c63a0918fa9b43717e389b470c4accdf6\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"https://bourns.space/p/covers/assets/images/lee-leopard.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://simplifymedia.pw/images/bnd/news/23908t5.png\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://wuzhenfestival.site/5109c46d40f801a862c96e628f83faca.png\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://onyangdol.site/thumb_d_F3D14F4982A256B5CDAE9BD579429AE7.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://kebhana.site/Believe-Me-Lyrics.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://mingxing.pw/datastream/thumb_b/43950sec.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://hssenglish.pw/fonini/pundit/leaf_background.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://frivol.space/memnet-profiles/A10818.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://ellechina.online/01_logo_HLW-300x168.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://wordrow.website/pictures-91.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://sellmyhousequickly.website/dangjiansigeyishibiaoyuxuanchuanguahua.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"https://mingxing.pw/content/_processed_/f/a/_742fa0bbd1.jpg\",\n\"type\": \"url\"\n},\n{\n\"value\": \"9f914d42706fe215501044acd85a32d58aaef1419d404fddfa5d3b48f66ccd9f\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"c52b831c4471e30ef6bd816db7b62fefeb3fa4ef0ce2cf46d70e527f624abe2d\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"63854e78780866d2ae56a58958a1fda017a71f54b71fe70cf5403958e961862a\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"bc866cfcdda37e24dc2634dc282c7a0e6f55209da17a8fa105b07414c0e7c527\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"607db30c205bf1ebb66522926b652a575cf5f454ade15563fc62e7523de7e150\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"d7577fb88cca3169c7931dc0d8ec9a444227dc14f6c71d6d39d86a0c5cad1976\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"25c8266d2bc1d5626dcdf72419838b397d28d44d00ac09f02ff4e421b43ec369\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"c92c158d7c37fea795114fa6491fe5f145ad2f8c08776b18ae79db811e8e36a3\",\n\"type\": \"sha256\"\n},\n{\n\"value\": \"35.162.239.174\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"34.120.208.123\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"35.244.181.201\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"34.149.100.209\",\n\"type\": \"ip\"\n},\n{\n\"value\": \"108.156.245.68\",\n\"type\": \"ip\"\n}\n],\n\"sightings\": {\n\"Secure Endpoint\": [\n{\n\"title\": \"ExecutedMalware.ioc\",\n\"description\": \"A known malicious file was executed. This increases the likelihood of a successful breach and this event should be promptly investigated.\"\n},\n{\n\"title\": \"Threat Detected\",\n\"description\": \"A known malicious file was detected on the system.\"\n},\n{\n\"title\": \"System Process Protection\",\n\"description\": \"A critical system process was seen involved in potentially dangerous activity.\"\n},\n{\n\"title\": \"W32.ActiveDirectoryDatabaseExtractionAttempt.ioc\",\n\"description\": \"An atttempt was made to extracted the Active Directory Database (ntds.dit) from a shadow copy. While this could be a legitimate attempt to recover from failure, this is also a known technique to extract the ntds.dit file which is normally locked and protected by the OS. After extraction, the attackers use a boot-key derived from subkeys in the registry (HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Lsa) to decode the ntds.dit file and extract password hashes. These hashes can then be used in pass-the-hash attacks.\"\n},\n{\n\"title\": \"W32.RegSaveSystem.ioc\",\n\"description\": \"The reg key tool was used to save the system subkey of the local-machine hive to a temporary location. This is anomalous. Attackers may dump out system subkey to extract sensitive information, like the boot key used to encrypt the Active Directory Database (ntds.dit). While this can be done on the active target, many attackers evade defenses by simply dumping the full system subkey and using tools like DSInternals to extract boot keys offline.\"\n},\n{\n\"title\": \"W32.PossibleRansomwareShadowCopyDeletion.ioc\",\n\"description\": \"Shadow copies are snapshots of part of the filesystem, used for backups and restore points. Ransomware may delete these to prevent the user from restoring files that it has encrypted or destroyed. Aside from ransomware, shadow copy deletion may also be used by other types of malware to remove forensic evidence of malicious activity.\"\n},\n{\n\"title\": \"W32.VeeamServicesDisabled.ioc\",\n\"description\": \"Veeam Backup and Replication is a comprehensive backup, recovery, and data management solutions platform used to back up, restore and replicate data on virtual machines. Disabling backup services to impact data recovery is a common technique utilized by ransomware threat actors. This IOC triggers when an attempt is made to disable Veeam backup services.\"\n},\n{\n\"title\": \"W32.AdFindUsage.ioc\",\n\"description\": \"AdFind is a command-line tool used for querying and extracting data from Active Directory. Although the use of AdFind is not necessarily malicious but it needs further investigation to determine if it was leveraged to perform reconnaissance. An attempt to execute AdFind was observed to dump Active Directory group memberships.\"\n},\n{\n\"title\": \"W32.PossibleRansomwareShadowCopyDownsize.ioc\",\n\"description\": \"Vssadmin is a legitimte Windows process that manages volume shadow copies of the files in a system. Shadow copies are backups of certain parts of the file system that can be used as restoration points. Some malware, particularly ransomware families, try to prevent the user from restoring encrypted or destroyed files by removing shadow copies. But since deletion of shadow copies is suspicious, threat actors use other ways to carry out this task, such as using vssadmin.exe to specify the maximum size of the storage area. Ransomware like ProLock, Ryuk, PwndLocker or HildaCrypt resize the storage area for shadow copies to a value of 401 MB.\"\n},\n{\n\"title\": \"Retrospective Quarantine Attempt Failed\",\n\"description\": \"The disposition of a previously unknown file was changed to malicious, but Secure Endpoint was unable to retroactively quarantine it successfully.\"\n}\n],\n\"Umbrella\": [\n{\n\"title\": \"Command and Control DNS Activities\",\n\"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\"\n}\n],\n\"Cisco XDR Analytics\": [\n{\n\"title\": \"Confirmed Threat Indicator Match - IP\",\n\"description\": \"Device communicated with an IP address listed as an IOC for a known threat.\"\n},\n{\n\"title\": \"Confirmed Threat Indicator Match - URL\",\n\"description\": \"Device communicated with an IP address listed as an IOC for a known threat.\"\n},\n{\n\"title\": \"Domain Generation Algorithm Successful Lookup\",\n\"description\": \"Device succeeded in resolving an algorithmically generated domain (e.g., rgkte-hdvj.cc) to an IP address. This alert uses the Domain Generation Algorithm Success observation and may indicate a malware infection or botnet activity.\"\n},\n{\n\"title\": \"Unusual DNS Connection\",\n\"description\": \"Device contacted an unusual DNS resolver and then established periodic connections with a remote device. This alert uses the Unusual DNS Resolver and Heartbeat observations and may indicate that the device is compromised.\"\n}\n],\n\"CrowdStrike Falcon\": [\n{\n\"title\": \"CrowdStrike Falcon Detection\",\n\"description\": \"Observable detected.\"\n}\n]\n}\n}",
          "scope": "static",
          "name": "MXDR_OPTIONS",
          "type": "datatype.string",
          "description": "Data sets from which to choose for a bundle",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1,
          "scope": "input",
          "name": "num_incidents",
          "type": "datatype.integer",
          "description": "Number of XDR Incidents to choose.\n1 - 5",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_0281EQD3D0KQJ1TnhNRZy3QwCKrNY2YL39f",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.boolean",
        "properties": {
          "value": false,
          "scope": "input",
          "name": "regsavessystem_bool",
          "type": "datatype.boolean",
          "is_required": false,
          "display_on_wizard": false,
          "is_invisible": false,
          "variable_string_format": ""
        },
        "unique_name": "variable_workflow_02EK99L9ORRHO5BnOedpwEFuoksW0aEjCYE",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "description": "Simulates detection Incidents created by Cisco Security Products.\n\nOriginal Author: Kevin Perkins",
      "display_name": "CL Amsterdam XDR Incident Generator",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "no_target": true
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_0284VDZIQVIBB3W6TphKpn7W0kTnb9zeoWG",
        "name": "Condition Block",
        "title": "Validate Input",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Validate Input",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_0284VDZJ5UVS022WLN4pecPiGlZhmC7ncfx",
            "name": "Condition Branch",
            "title": "\u003e5",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_0281EQD3D0KQJ1TnhNRZy3QwCKrNY2YL39f$",
                "operator": "gt",
                "right_operand": 5
              },
              "continue_on_failure": false,
              "display_name": "\u003e5",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_0284VEJ3D200I4bwHm8vCDDQuHN4RwLZeBM",
                "name": "Set Variables",
                "title": "Set Max Incidents",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Max Incidents",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_0281EQD3D0KQJ1TnhNRZy3QwCKrNY2YL39f$",
                      "variable_value_new": 5
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_0284VETHRUWP75kWvS9oBakz4q6MajdjiJs",
            "name": "Condition Branch",
            "title": "\u003c1",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_0281EQD3D0KQJ1TnhNRZy3QwCKrNY2YL39f$",
                "operator": "lt",
                "right_operand": 1
              },
              "continue_on_failure": false,
              "display_name": "\u003c1",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_0284VETHRW49O6ONs5ElDfoMwCAXSaNjWJp",
                "name": "Set Variables",
                "title": "Set Min Incidents",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Min Incidents",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_0281EQD3D0KQJ1TnhNRZy3QwCKrNY2YL39f$",
                      "variable_value_new": 1
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02DIX01OQET9B6JUqb3LssLJcTnSZHVIDzd",
        "name": "Condition Block",
        "title": "cnc_bool == true?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "cnc_bool == true?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02DIX01P2ZQW35O6Q1XkWy2ZlZ5NW83hTLB",
            "name": "Condition Branch",
            "title": "Condition Branch",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_02DIWZG4DO1E94SPsoFWkNCkrItrF6QDIJG$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Condition Branch",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02DUNQ93U17E611Jp8VX9fQ0bbG1gtNj9Ye",
                "name": "HTTP Request",
                "title": "Post Incident Bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"source\": \"Umbrella\",\n  \"incidents\": [\n    {\n      \"id\": \"transient:incident-8e575813-26c9-407d-9c88-cccf3d930521\",\n      \"title\": \"Command and Control DNS Activities [live]\",\n      \"type\": \"incident\",\n      \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n      \"source\": \"Umbrella\",\n      \"status\": \"New\",\n      \"short_description\": \"\",\n      \"incident_time\": {\n        \"opened\": \"2024-04-23T15:18:14Z\"\n      },\n      \"tlp\": \"white\",\n      \"confidence\": \"High\",\n      \"severity\": \"Critical\",\n      \"schema_version\": \"1.3.7\",\n      \"tactics\": [\n        \"TA0043\",\n        \"TA0004\"\n      ],\n      \"techniques\": [\n        \"T1113\",\n        \"T1219\",\n        \"T1022\"\n      ]\n    }\n  ],\n  \"sightings\": [\n    {\n      \"id\": \"transient:sighting-07b4f08e-6890-47a7-b597-f0fa0454f364\",\n      \"title\": \"Command and Control DNS Activities\",\n      \"type\": \"sighting\",\n      \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\",\n      \"source\": \"Umbrella\",\n      \"observables\": [\n        {\n          \"value\": \"galyqaz.com\",\n          \"type\": \"domain\"\n        },\n        {\n          \"value\": \"joymagnutwy.cyou\",\n          \"type\": \"domain\"\n        },\n        {\n          \"value\": \"mezhdu-delom.ru\",\n          \"type\": \"domain\"\n        }\n      ],\n      \"targets\": [\n        {\n          \"type\": \"endpoint\",\n          \"observables\": [\n            {\n              \"value\": \"ad1.cmsdc.cisco.com\",\n              \"type\": \"hostname\"\n            },\n            {\n              \"value\": \"10.0.74.41\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"64.102.255.47\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n              \"type\": \"amp_computer_guid\"\n            },\n            {\n              \"value\": \"maclemon@skynet.lab\",\n              \"type\": \"user\"\n            }\n          ],\n          \"observed_time\": {\n            \"start_time\": \"2024-04-23T15:18:14Z\"\n          }\n        }\n      ],\n      \"observed_time\": {\n        \"start_time\": \"2024-04-23T15:18:14Z\"\n      },\n      \"external_ids\": [],\n      \"tlp\": \"white\",\n      \"confidence\": \"High\",\n      \"severity\": \"Medium\"\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"transient:relationship-0f19fef2-5e62-40cb-aa1f-5a6029c2e4e2\",\n      \"title\": \"\",\n      \"type\": \"relationship\",\n      \"description\": \"\",\n      \"source\": \"Umbrella\",\n      \"external_ids\": [],\n      \"source_ref\": \"transient:sighting-07b4f08e-6890-47a7-b597-f0fa0454f364\",\n      \"target_ref\": \"transient:incident-8e575813-26c9-407d-9c88-cccf3d930521\",\n      \"relationship_type\": \"member-of\",\n      \"timestamp\": \"2024-04-23T15:18:14Z\"\n    }\n  ]\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Post Incident Bundle",
                  "method": "POST",
                  "relative_url": "/private-intel/bundle/import?external-key-prefixes=xdrauto",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DUNQH8E8HZK3B1GkNLRuQDbc9ALv8Ow0C",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02DIX0IKK7X2Y1HdXj3WXMQiP0d5T6vsWvi",
                "name": "Set Variables",
                "title": "Set Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.static.variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx$",
                      "variable_value_new": "{\n    \"source\": [\n        \"Umbrella\"\n    ],\n    \"tlp\": [\n        \"red\"\n    ],\n    \"confidence\": [\n        \"High\"\n    ],\n    \"severity\": [\n        \"Medium\",\n        \"High\",\n        \"Critical\"\n    ],\n    \"tactics\": [\n        \"TA0001\",\n        \"TA0002\",\n        \"TA0003\",\n        \"TA0004\",\n        \"TA0005\",\n        \"TA0006\",\n        \"TA0007\",\n        \"TA0008\",\n        \"TA0009\",\n        \"TA0010\",\n        \"TA0011\",\n        \"TA0040\",\n        \"TA0042\",\n        \"TA0043\"\n    ],\n    \"techniques\": [\n        \"T1001\",\n        \"T1022\",\n        \"T1041\",\n        \"T1056.001\",\n        \"T1059.005\",\n        \"T1071.001\",\n        \"T1113\",\n        \"T1204.002\",\n        \"T1204.003\",\n        \"T1219\",\n        \"T1566.002\",\n        \"T1567\",\n        \"T1586.002\",\n        \"T1588.001\",\n        \"T1589\",\n        \"T1591\",\n        \"T1598.002\",\n        \"T1095\"\n    ],\n    \"targets\": [\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad2.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.42\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"464c7ae9-5cef-44f2-812c-c280ceabac89\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        },\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad1.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.41\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        }\n    ],\n    \"observables\": [\n        {\n            \"value\": \"monsteradds.at\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"imestre.suzukiburgman.top\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"ssl.suzukiburgman.top\",\n            \"type\": \"domain\"\n        }\n    ],\n    \"sightings\": {\n        \"Umbrella\": [\n            {\n                \"title\": \"Command and Control DNS Activities\",\n                \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\"\n            }\n        ]\n    }\n}"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02EJGSXAM8V7B3Rt8SPCboiDbWApRF2yAow",
        "name": "Condition Block",
        "title": "ransom_bool == true?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "ransom_bool == true?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02EJGSXAM9F2H36Qv4i1wcUnosU87FuCgCP",
            "name": "Condition Branch",
            "title": "Condition Branch",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_02EJGUEOUXPUF1eYTu8Qh4khvnz4oISBryu$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Condition Branch",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02EJGSXAMCZ4Y2U1JN7nGx5zovykudaFsDx",
                "name": "HTTP Request",
                "title": "Post Incident Bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"source\": \"Secure Endpoint\",\n  \"incidents\": [\n    {\n      \"id\": \"transient:incident-d6db9c95-8a07-4743-aeca-e3c6a65358cc\",\n      \"title\": \"W32.PossibleRansomwareShadowCopyDownsize.ioc [live]\",\n      \"type\": \"incident\",\n      \"description\": \"Vssadmin is a legitimte Windows process that manages volume shadow copies of the files in a system. Shadow copies are backups of certain parts of the file system that can be used as restoration points. Some malware, particularly ransomware families, try to prevent the user from restoring encrypted or destroyed files by removing shadow copies. But since deletion of shadow copies is suspicious, threat actors use other ways to carry out this task, such as using vssadmin.exe to specify the maximum size of the storage area. Ransomware like ProLock, Ryuk, PwndLocker or HildaCrypt resize the storage area for shadow copies to a value of 401 MB.\",\n      \"source\": \"Secure Endpoint\",\n      \"status\": \"New\",\n      \"short_description\": \"\",\n      \"incident_time\": {\n        \"opened\": \"2024-05-22T15:35:23Z\"\n      },\n      \"tlp\": \"amber\",\n      \"confidence\": \"High\",\n      \"severity\": \"None\",\n      \"schema_version\": \"1.3.7\",\n      \"tactics\": [\n        \"TA0004\",\n        \"TA0043\"\n      ],\n      \"techniques\": [\n        \"T1041\",\n        \"T1566.002\",\n        \"T1589\"\n      ]\n    }\n  ],\n  \"sightings\": [\n    {\n      \"id\": \"transient:sighting-352c81e7-029d-447b-8a7a-77d35ae7313c\",\n      \"title\": \"W32.PossibleRansomwareShadowCopyDownsize.ioc\",\n      \"type\": \"sighting\",\n      \"description\": \"Vssadmin is a legitimte Windows process that manages volume shadow copies of the files in a system. Shadow copies are backups of certain parts of the file system that can be used as restoration points. Some malware, particularly ransomware families, try to prevent the user from restoring encrypted or destroyed files by removing shadow copies. But since deletion of shadow copies is suspicious, threat actors use other ways to carry out this task, such as using vssadmin.exe to specify the maximum size of the storage area. Ransomware like ProLock, Ryuk, PwndLocker or HildaCrypt resize the storage area for shadow copies to a value of 401 MB.\",\n      \"source\": \"Umbrella\",\n      \"observables\": [\n        {\n          \"value\": \"https://hssenglish.pw/fonini/pundit/leaf_background.jpg\",\n          \"type\": \"url\"\n        },\n        {\n          \"value\": \"https://simplifymedia.pw/images/bnd/news/23908t5.png\",\n          \"type\": \"url\"\n        },\n        {\n          \"value\": \"https://wordrow.website/pictures-91.jpg\",\n          \"type\": \"url\"\n        }\n      ],\n      \"targets\": [\n        {\n          \"type\": \"endpoint\",\n          \"observables\": [\n            {\n              \"value\": \"ad1.cmsdc.cisco.com\",\n              \"type\": \"hostname\"\n            },\n            {\n              \"value\": \"10.0.74.41\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"64.102.255.47\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n              \"type\": \"amp_computer_guid\"\n            }\n          ],\n          \"observed_time\": {\n            \"start_time\": \"2024-05-22T15:35:23Z\"\n          }\n        }\n      ],\n      \"observed_time\": {\n        \"start_time\": \"2024-05-22T15:35:23Z\"\n      },\n      \"external_ids\": [],\n      \"tlp\": \"green\",\n      \"confidence\": \"Medium\",\n      \"severity\": \"High\"\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"transient:relationship-49b28d50-f21e-4db6-b0e9-faad2cd32fda\",\n      \"title\": \"\",\n      \"type\": \"relationship\",\n      \"description\": \"\",\n      \"source\": \"Cisco XDR Analytics\",\n      \"external_ids\": [],\n      \"source_ref\": \"transient:sighting-352c81e7-029d-447b-8a7a-77d35ae7313c\",\n      \"target_ref\": \"transient:incident-d6db9c95-8a07-4743-aeca-e3c6a65358cc\",\n      \"relationship_type\": \"member-of\",\n      \"timestamp\": \"2024-05-22T15:35:23Z\"\n    }\n  ]\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Post Incident Bundle",
                  "method": "POST",
                  "relative_url": "/private-intel/bundle/import?external-key-prefixes=xdrauto",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EJGSXAME7T341QIrXKLBkkuL74QuFgtQM",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EJGSXAMG75B2i8ZyDdBINDdvZWnJxz5Pr",
                "name": "Set Variables",
                "title": "Set Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.static.variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx$",
                      "variable_value_new": "{\n    \"source\": [\n        \"Umbrella\"\n    ],\n    \"tlp\": [\n        \"red\"\n    ],\n    \"confidence\": [\n        \"High\"\n    ],\n    \"severity\": [\n        \"Medium\",\n        \"High\",\n        \"Critical\"\n    ],\n    \"tactics\": [\n        \"TA0001\",\n        \"TA0002\",\n        \"TA0003\",\n        \"TA0004\",\n        \"TA0005\",\n        \"TA0006\",\n        \"TA0007\",\n        \"TA0008\",\n        \"TA0009\",\n        \"TA0010\",\n        \"TA0011\",\n        \"TA0040\",\n        \"TA0042\",\n        \"TA0043\"\n    ],\n    \"techniques\": [\n        \"T1001\",\n        \"T1022\",\n        \"T1041\",\n        \"T1056.001\",\n        \"T1059.005\",\n        \"T1071.001\",\n        \"T1113\",\n        \"T1204.002\",\n        \"T1204.003\",\n        \"T1219\",\n        \"T1566.002\",\n        \"T1567\",\n        \"T1586.002\",\n        \"T1588.001\",\n        \"T1589\",\n        \"T1591\",\n        \"T1598.002\",\n        \"T1095\"\n    ],\n    \"targets\": [\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad2.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.42\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"464c7ae9-5cef-44f2-812c-c280ceabac89\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        },\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad1.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.41\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        }\n    ],\n    \"observables\": [\n        {\n            \"value\": \"monsteradds.at\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"imestre.suzukiburgman.top\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"ssl.suzukiburgman.top\",\n            \"type\": \"domain\"\n        }\n    ],\n    \"sightings\": {\n        \"Umbrella\": [\n            {\n                \"title\": \"Command and Control DNS Activities\",\n                \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\"\n            }\n        ]\n    }\n}"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02EK8T0VC7IV83vl3BMyYIN2Kt0XJOtuFpe",
        "name": "Condition Block",
        "title": "quarantine_bool == true?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "quarantine_bool == true?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02EK8T0VC897K3GvfwMYHUQTMNfDrT5bZfv",
            "name": "Condition Branch",
            "title": "Condition Branch",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_02EK8TM5EYES17VWuLyPNzJJkLVtyyG2c8R$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Condition Branch",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02EK8T0VCAN702fBxnVaK1knz0rp3SurGge",
                "name": "HTTP Request",
                "title": "Post Incident Bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"source\": \"Secure Endpoint\",\n  \"incidents\": [\n    {\n      \"id\": \"transient:incident-7ff78a71-2192-44b9-bc34-e317de038223\",\n      \"title\": \"Retrospective Quarantine Attempt Failed [live]\",\n      \"type\": \"incident\",\n      \"description\": \"The disposition of a previously unknown file was changed to malicious, but Secure Endpoint was unable to retroactively quarantine it successfully.\",\n      \"source\": \"Secure Endpoint\",\n      \"status\": \"New\",\n      \"short_description\": \"\",\n      \"incident_time\": {\n        \"opened\": \"2024-05-23T13:32:26Z\"\n      },\n      \"tlp\": \"amber\",\n      \"confidence\": \"High\",\n      \"severity\": \"Unknown\",\n      \"schema_version\": \"1.3.7\",\n      \"tactics\": [\n        \"TA0010\",\n        \"TA0004\"\n      ],\n      \"techniques\": [\n        \"T1586.002\",\n        \"T1001\",\n        \"T1588.001\"\n      ]\n    }\n  ],\n  \"sightings\": [\n    {\n      \"id\": \"transient:sighting-59442964-5ec2-47d4-9e52-385e0e05144b\",\n      \"title\": \"Retrospective Quarantine Attempt Failed\",\n      \"type\": \"sighting\",\n      \"description\": \"The disposition of a previously unknown file was changed to malicious, but Secure Endpoint was unable to retroactively quarantine it successfully.\",\n      \"source\": \"Secure Endpoint\",\n      \"observables\": [\n        {\n          \"value\": \"d7577fb88cca3169c7931dc0d8ec9a444227dc14f6c71d6d39d86a0c5cad1976\",\n          \"type\": \"sha256\"\n        },\n        {\n          \"value\": \"25c8266d2bc1d5626dcdf72419838b397d28d44d00ac09f02ff4e421b43ec369\",\n          \"type\": \"sha256\"\n        },\n        {\n          \"value\": \"https://hssenglish.pw/fonini/pundit/leaf_background.jpg\",\n          \"type\": \"url\"\n        }\n      ],\n      \"targets\": [\n{\n          \"type\": \"endpoint\",\n          \"observables\": [\n            {\n              \"value\": \"ad1.cmsdc.cisco.com\",\n              \"type\": \"hostname\"\n            },\n            {\n              \"value\": \"10.0.74.41\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"64.102.255.47\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n              \"type\": \"amp_computer_guid\"\n            }\n          ],\n          \"observed_time\": {\n            \"start_time\": \"2024-05-23T13:32:26Z\"\n          }\n        }\n      ],\n      \"observed_time\": {\n        \"start_time\": \"2024-05-23T13:32:26Z\"\n      },\n      \"external_ids\": [],\n      \"tlp\": \"green\",\n      \"confidence\": \"None\",\n      \"severity\": \"Critical\"\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"transient:relationship-37789aa1-5ad1-4411-85be-8df68a4164dc\",\n      \"title\": \"\",\n      \"type\": \"relationship\",\n      \"description\": \"\",\n      \"source\": \"Cisco XDR Analytics\",\n      \"external_ids\": [],\n      \"source_ref\": \"transient:sighting-59442964-5ec2-47d4-9e52-385e0e05144b\",\n      \"target_ref\": \"transient:incident-7ff78a71-2192-44b9-bc34-e317de038223\",\n      \"relationship_type\": \"member-of\",\n      \"timestamp\": \"2024-05-23T13:32:26Z\"\n    }\n  ]\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Post Incident Bundle",
                  "method": "POST",
                  "relative_url": "/private-intel/bundle/import?external-key-prefixes=xdrauto",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EK8T0VCD4GZ4ZHBPOIZ430mXizwiBcckd",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EK8T0VCE37H2NmERVIItMhUHaQh0QceiU",
                "name": "Set Variables",
                "title": "Set Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.static.variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx$",
                      "variable_value_new": "{\n    \"source\": [\n        \"Umbrella\"\n    ],\n    \"tlp\": [\n        \"red\"\n    ],\n    \"confidence\": [\n        \"High\"\n    ],\n    \"severity\": [\n        \"Medium\",\n        \"High\",\n        \"Critical\"\n    ],\n    \"tactics\": [\n        \"TA0001\",\n        \"TA0002\",\n        \"TA0003\",\n        \"TA0004\",\n        \"TA0005\",\n        \"TA0006\",\n        \"TA0007\",\n        \"TA0008\",\n        \"TA0009\",\n        \"TA0010\",\n        \"TA0011\",\n        \"TA0040\",\n        \"TA0042\",\n        \"TA0043\"\n    ],\n    \"techniques\": [\n        \"T1001\",\n        \"T1022\",\n        \"T1041\",\n        \"T1056.001\",\n        \"T1059.005\",\n        \"T1071.001\",\n        \"T1113\",\n        \"T1204.002\",\n        \"T1204.003\",\n        \"T1219\",\n        \"T1566.002\",\n        \"T1567\",\n        \"T1586.002\",\n        \"T1588.001\",\n        \"T1589\",\n        \"T1591\",\n        \"T1598.002\",\n        \"T1095\"\n    ],\n    \"targets\": [\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad2.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.42\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"464c7ae9-5cef-44f2-812c-c280ceabac89\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        },\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad1.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.41\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        }\n    ],\n    \"observables\": [\n        {\n            \"value\": \"monsteradds.at\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"imestre.suzukiburgman.top\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"ssl.suzukiburgman.top\",\n            \"type\": \"domain\"\n        }\n    ],\n    \"sightings\": {\n        \"Umbrella\": [\n            {\n                \"title\": \"Command and Control DNS Activities\",\n                \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\"\n            }\n        ]\n    }\n}"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02EK99N3O2A9F19J9ooZ2Z6qQrEgrFPk8WO",
        "name": "Condition Block",
        "title": "regsavesystem_bool == true?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "regsavesystem_bool == true?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02EK99N3O310L2sz2ng9ZiHUi2ofLTC66NQ",
            "name": "Condition Branch",
            "title": "Condition Branch",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_02EK99L9ORRHO5BnOedpwEFuoksW0aEjCYE$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Condition Branch",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02EK99N3O5I7E1pHtVgv6S5hQfHzvPQRPAB",
                "name": "HTTP Request",
                "title": "Post Incident Bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"source\": \"Secure Endpoint\",\n  \"incidents\": [\n    {\n      \"id\": \"transient:incident-0326f7e0-c227-4813-bd85-51b461ea15f1\",\n      \"title\": \"W32.RegSaveSystem.ioc [live]\",\n      \"type\": \"incident\",\n      \"description\": \"The reg key tool was used to save the system subkey of the local-machine hive to a temporary location. This is anomalous. Attackers may dump out system subkey to extract sensitive information, like the boot key used to encrypt the Active Directory Database (ntds.dit). While this can be done on the active target, many attackers evade defenses by simply dumping the full system subkey and using tools like DSInternals to extract boot keys offline.\",\n      \"source\": \"Secure Endpoint\",\n      \"status\": \"New\",\n      \"short_description\": \"\",\n      \"incident_time\": {\n        \"opened\": \"2024-05-23T13:29:33Z\"\n      },\n      \"tlp\": \"red\",\n      \"confidence\": \"High\",\n      \"severity\": \"Critical\",\n      \"schema_version\": \"1.3.7\",\n      \"tactics\": [\n        \"TA0010\",\n        \"TA0007\"\n      ],\n      \"techniques\": [\n        \"T1059.005\",\n        \"T1095\",\n        \"T1589\"\n      ]\n    }\n  ],\n  \"sightings\": [\n    {\n      \"id\": \"transient:sighting-56891651-d0cd-4b7d-a45c-99d55ef457d4\",\n      \"title\": \"W32.RegSaveSystem.ioc\",\n      \"type\": \"sighting\",\n      \"description\": \"The reg key tool was used to save the system subkey of the local-machine hive to a temporary location. This is anomalous. Attackers may dump out system subkey to extract sensitive information, like the boot key used to encrypt the Active Directory Database (ntds.dit). While this can be done on the active target, many attackers evade defenses by simply dumping the full system subkey and using tools like DSInternals to extract boot keys offline.\",\n      \"source\": \"CrowdStrike Falcon\",\n      \"observables\": [\n        {\n          \"value\": \"https://onyangdol.site/thumb_d_F3D14F4982A256B5CDAE9BD579429AE7.jpg\",\n          \"type\": \"url\"\n        },\n        {\n          \"value\": \"607db30c205bf1ebb66522926b652a575cf5f454ade15563fc62e7523de7e150\",\n          \"type\": \"sha256\"\n        },\n        {\n          \"value\": \"https://wordrow.website/pictures-91.jpg\",\n          \"type\": \"url\"\n        }\n      ],\n      \"targets\": [\n {\n          \"type\": \"endpoint\",\n          \"observables\": [\n            {\n              \"value\": \"ad1.cmsdc.cisco.com\",\n              \"type\": \"hostname\"\n            },\n            {\n              \"value\": \"10.0.74.41\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"64.102.255.47\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n              \"type\": \"amp_computer_guid\"\n            },\n            {\n              \"value\": \"maclemon@skynet.lab\",\n              \"type\": \"user\"\n            }\n          ],\n          \"observed_time\": {\n            \"start_time\": \"2024-04-23T15:18:14Z\"\n          }\n        }\n      ],\n      \"observed_time\": {\n        \"start_time\": \"2024-05-23T13:29:33Z\"\n      },\n      \"external_ids\": [],\n      \"tlp\": \"red\",\n      \"confidence\": \"Unknown\",\n      \"severity\": \"Info\"\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"transient:relationship-508d6247-d011-4c72-be6c-5077ef0b866b\",\n      \"title\": \"\",\n      \"type\": \"relationship\",\n      \"description\": \"\",\n      \"source\": \"Umbrella\",\n      \"external_ids\": [],\n      \"source_ref\": \"transient:sighting-56891651-d0cd-4b7d-a45c-99d55ef457d4\",\n      \"target_ref\": \"transient:incident-0326f7e0-c227-4813-bd85-51b461ea15f1\",\n      \"relationship_type\": \"member-of\",\n      \"timestamp\": \"2024-05-23T13:29:33Z\"\n    }\n  ]\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Post Incident Bundle",
                  "method": "POST",
                  "relative_url": "/private-intel/bundle/import?external-key-prefixes=xdrauto",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EK99N3O7SRX2PHY9o4sFe41jWLEwkao05",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EK99N3O8V4Y3hvV31BUENY0jGHKqF72ir",
                "name": "Set Variables",
                "title": "Set Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.static.variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx$",
                      "variable_value_new": "{\n    \"source\": [\n        \"Umbrella\"\n    ],\n    \"tlp\": [\n        \"red\"\n    ],\n    \"confidence\": [\n        \"High\"\n    ],\n    \"severity\": [\n        \"Medium\",\n        \"High\",\n        \"Critical\"\n    ],\n    \"tactics\": [\n        \"TA0001\",\n        \"TA0002\",\n        \"TA0003\",\n        \"TA0004\",\n        \"TA0005\",\n        \"TA0006\",\n        \"TA0007\",\n        \"TA0008\",\n        \"TA0009\",\n        \"TA0010\",\n        \"TA0011\",\n        \"TA0040\",\n        \"TA0042\",\n        \"TA0043\"\n    ],\n    \"techniques\": [\n        \"T1001\",\n        \"T1022\",\n        \"T1041\",\n        \"T1056.001\",\n        \"T1059.005\",\n        \"T1071.001\",\n        \"T1113\",\n        \"T1204.002\",\n        \"T1204.003\",\n        \"T1219\",\n        \"T1566.002\",\n        \"T1567\",\n        \"T1586.002\",\n        \"T1588.001\",\n        \"T1589\",\n        \"T1591\",\n        \"T1598.002\",\n        \"T1095\"\n    ],\n    \"targets\": [\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad2.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.42\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"464c7ae9-5cef-44f2-812c-c280ceabac89\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        },\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad1.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.41\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        }\n    ],\n    \"observables\": [\n        {\n            \"value\": \"monsteradds.at\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"imestre.suzukiburgman.top\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"ssl.suzukiburgman.top\",\n            \"type\": \"domain\"\n        }\n    ],\n    \"sightings\": {\n        \"Umbrella\": [\n            {\n                \"title\": \"Command and Control DNS Activities\",\n                \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\"\n            }\n        ]\n    }\n}"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_02EK9D61DIC4C5MrqPJB8p2Asb5OqrcfcXI",
        "name": "Condition Block",
        "title": "malfile_bool == true?",
        "type": "logic.if_else",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "malfile_bool == true?",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_02EK9D61DIZUW4OePyiRfqc0BLygJwuExL0",
            "name": "Condition Branch",
            "title": "Condition Branch",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_02EK9DGD8NSB11oqc4UrWlO3KBxwfqPLn98$",
                "operator": "eq",
                "right_operand": true
              },
              "continue_on_failure": false,
              "display_name": "Condition Branch",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_02EK9D61DMEG73peIsLYLg6Hu1uHCnpvpb6",
                "name": "HTTP Request",
                "title": "Post Incident Bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "{\n  \"source\": \"Secure Endpoint\",\n  \"incidents\": [\n    {\n      \"id\": \"transient:incident-e60f3fe0-f63d-4fc3-9c00-3ba3cc894cb2\",\n      \"title\": \"Threat Detected [live]\",\n      \"type\": \"incident\",\n      \"description\": \"A known malicious file was detected on the system.\",\n      \"source\": \"Secure Endpoint\",\n      \"status\": \"New\",\n      \"short_description\": \"\",\n      \"incident_time\": {\n        \"opened\": \"2024-05-23T13:29:31Z\"\n      },\n      \"tlp\": \"green\",\n      \"confidence\": \"Info\",\n      \"severity\": \"Info\",\n      \"schema_version\": \"1.3.7\",\n      \"tactics\": [\n        \"TA0002\",\n        \"TA0007\"\n      ],\n      \"techniques\": [\n        \"T1071.001\",\n        \"T1219\",\n        \"T1589\"\n      ]\n    }\n  ],\n  \"sightings\": [\n    {\n      \"id\": \"transient:sighting-d9349781-052d-4407-8289-9b59cb153e31\",\n      \"title\": \"Threat Detected\",\n      \"type\": \"sighting\",\n      \"description\": \"A known malicious file was detected on the system.\",\n      \"source\": \"CrowdStrike Falcon\",\n      \"observables\": [\n        {\n          \"value\": \"e9c5a42bdcca52bd24b095eae55dbc5c63a0918fa9b43717e389b470c4accdf6\",\n          \"type\": \"sha256\"\n        },\n        {\n          \"value\": \"b99d61d874728edc0918ca0eb10eab93d381e7367e377406e65963366c874450\",\n          \"type\": \"sha256\"\n        },\n        {\n          \"value\": \"607db30c205bf1ebb66522926b652a575cf5f454ade15563fc62e7523de7e150\",\n          \"type\": \"sha256\"\n        }\n      ],\n      \"targets\": [\n{\n              \"value\": \"ad1.cmsdc.cisco.com\",\n              \"type\": \"hostname\"\n            },\n            {\n              \"value\": \"10.0.74.41\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"64.102.255.47\",\n              \"type\": \"ip\"\n            },\n            {\n              \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n              \"type\": \"amp_computer_guid\"\n            },\n            {\n              \"value\": \"maclemon@skynet.lab\",\n              \"type\": \"user\"\n            }\n      ],\n      \"observed_time\": {\n        \"start_time\": \"2024-05-23T13:29:31Z\"\n      },\n      \"external_ids\": [],\n      \"tlp\": \"red\",\n      \"confidence\": \"Info\",\n      \"severity\": \"Low\"\n    }\n  ],\n  \"relationships\": [\n    {\n      \"id\": \"transient:relationship-52c65a63-bf8e-4c86-adf1-00b73e9c5c20\",\n      \"title\": \"\",\n      \"type\": \"relationship\",\n      \"description\": \"\",\n      \"source\": \"Cisco XDR Analytics\",\n      \"external_ids\": [],\n      \"source_ref\": \"transient:sighting-d9349781-052d-4407-8289-9b59cb153e31\",\n      \"target_ref\": \"transient:incident-e60f3fe0-f63d-4fc3-9c00-3ba3cc894cb2\",\n      \"relationship_type\": \"member-of\",\n      \"timestamp\": \"2024-05-23T13:29:31Z\"\n    }\n  ]\n}",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Post Incident Bundle",
                  "method": "POST",
                  "relative_url": "/private-intel/bundle/import?external-key-prefixes=xdrauto",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EK9D61DNTHU6EW8O0EKR1FtqUPWabLSfk",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_02EK9D61DPZ650klhuQMYdFoeDWOxxau4KL",
                "name": "Set Variables",
                "title": "Set Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.static.variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx$",
                      "variable_value_new": "{\n    \"source\": [\n        \"Umbrella\"\n    ],\n    \"tlp\": [\n        \"red\"\n    ],\n    \"confidence\": [\n        \"High\"\n    ],\n    \"severity\": [\n        \"Medium\",\n        \"High\",\n        \"Critical\"\n    ],\n    \"tactics\": [\n        \"TA0001\",\n        \"TA0002\",\n        \"TA0003\",\n        \"TA0004\",\n        \"TA0005\",\n        \"TA0006\",\n        \"TA0007\",\n        \"TA0008\",\n        \"TA0009\",\n        \"TA0010\",\n        \"TA0011\",\n        \"TA0040\",\n        \"TA0042\",\n        \"TA0043\"\n    ],\n    \"techniques\": [\n        \"T1001\",\n        \"T1022\",\n        \"T1041\",\n        \"T1056.001\",\n        \"T1059.005\",\n        \"T1071.001\",\n        \"T1113\",\n        \"T1204.002\",\n        \"T1204.003\",\n        \"T1219\",\n        \"T1566.002\",\n        \"T1567\",\n        \"T1586.002\",\n        \"T1588.001\",\n        \"T1589\",\n        \"T1591\",\n        \"T1598.002\",\n        \"T1095\"\n    ],\n    \"targets\": [\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad2.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.42\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"464c7ae9-5cef-44f2-812c-c280ceabac89\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        },\n        {\n            \"type\": \"endpoint\",\n            \"observables\": [\n                {\n                    \"value\": \"ad1.cmsdc.cisco.com\",\n                    \"type\": \"hostname\"\n                },\n                {\n                    \"value\": \"10.0.74.41\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"64.102.255.47\",\n                    \"type\": \"ip\"\n                },\n                {\n                    \"value\": \"4e9def48-573b-4cdd-b634-008772aba3ca\",\n                    \"type\": \"amp_computer_guid\"\n                },\n                {\n                    \"value\": \"maclemon@skynet.lab\",\n                    \"type\": \"user\"\n                }\n            ]\n        }\n    ],\n    \"observables\": [\n        {\n            \"value\": \"monsteradds.at\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"imestre.suzukiburgman.top\",\n            \"type\": \"domain\"\n        },\n        {\n            \"value\": \"ssl.suzukiburgman.top\",\n            \"type\": \"domain\"\n        }\n    ],\n    \"sightings\": {\n        \"Umbrella\": [\n            {\n                \"title\": \"Command and Control DNS Activities\",\n                \"description\": \"A device is involved in excessive malicious Command and Control communication, which is already flagged by Umbrella.\"\n            }\n        ]\n    }\n}"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_0284VD65FGEYY0rhOZi4gm7UCq38ae8Gw9Z",
        "name": "While Loop",
        "title": "While Loop",
        "type": "logic.while",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "While Loop",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "blocks": [
          {
            "unique_name": "definition_activity_0284VD662EXWH6Gg5JI5pGUSE86uPBZEvWn",
            "name": "Condition Branch",
            "title": "More incidents to create",
            "type": "logic.condition_block",
            "base_type": "activity",
            "properties": {
              "condition": {
                "left_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.input.variable_workflow_0281EQD3D0KQJ1TnhNRZy3QwCKrNY2YL39f$",
                "operator": "gte",
                "right_operand": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.local.variable_workflow_0284VFW8EF7D20XxyzK5UyQCzh1r8tBdSvv$"
              },
              "continue_on_failure": false,
              "display_name": "More incidents to create",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_0281E6YRHCL265tycVSGW4Yloz6yyiPHdew",
                "name": "Execute Python Script",
                "title": "Generate Incident Bundle",
                "type": "python3.script",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Generate Incident Bundle",
                  "script": "from dataclasses import dataclass, field, asdict\nimport random\nimport uuid\nimport json, sys\nfrom datetime import datetime\nfrom typing import Any\n\n\n@dataclass(kw_only=True)\nclass XDR_Base():\n    id: str = field(init=False)\n    title: str\n    type: str\n    description: str\n    source: str\n\n    def __post_init__(self):\n        self.id = f\"transient:{self.type}-{str(uuid.uuid4())}\"\n\n    def to_dict(self) -\u003e dict[str, Any]:\n        return {k: v for k, v in asdict(self).items()}\n\n@dataclass(kw_only=True)\nclass XDR_Incident(XDR_Base):\n    # id: str = f\"incident-{str(uuid.uuid4())}\"\n    type: str = \"incident\"\n    status: str\n    short_description: str\n    incident_time: dict[str, str] = field(default_factory=dict)\n    tlp: str\n    confidence: str\n    severity: str\n    schema_version: str\n    tactics: list[str] = field(default_factory=list)\n    techniques: list[str] = field(default_factory=list)\n\n@dataclass(kw_only=True)\nclass XDR_Sighting(XDR_Base):\n    type: str = \"sighting\"\n    observables: list[dict[str, str]] = field(default_factory=list)\n    targets: list[dict[str, Any]] = field(default_factory=list)\n    observed_time: dict[str, Any] = field(default_factory=dict)\n    external_ids: list[str] = field(default_factory=list)\n    tlp: str\n    confidence: str\n    severity: str\n\n@dataclass(kw_only=True)\nclass XDR_Relationship(XDR_Base):\n    type: str = \"relationship\"\n    external_ids: list[str] = field(default_factory=list)\n    source_ref: str\n    target_ref: str\n    relationship_type: str\n    timestamp: str\n\n@dataclass(kw_only=True)\nclass XDR_Bundle():\n    source: str\n    incidents: list[XDR_Incident] = field(default_factory=list)\n    sightings: list[XDR_Sighting] = field(default_factory=list)\n    relationships: list[XDR_Relationship] = field(default_factory=list)\n\n    def to_json(self) -\u003e dict[str, Any]:\n        return {\n            \"source\": self.source,\n            \"incidents\": [inc.to_dict() for inc in self.incidents],\n            \"sightings\": [sight.to_dict() for sight in self.sightings],\n            \"relationships\": [relation.to_dict() for relation in self.relationships]\n        }\n\ndef main(mxdr_options):\n    str_time_now = datetime.now().strftime(\"%Y-%m-%dT%H:%M:%SZ\")\n    source_selection = random.choice(mxdr_options.get(\"source\"))\n    sighting_entry = random.choice(mxdr_options.get(\"sightings\").get(source_selection, []))\n    target_selection = random.choice(mxdr_options.get(\"targets\"))\n    target_selection[\"observed_time\"] = {\"start_time\": str_time_now}\n\n    xdr_incident = XDR_Incident(\n        title=sighting_entry.get(\"title\")+\" [live]\",\n        description=sighting_entry.get(\"description\"),\n        source=source_selection,\n        status=\"New\",\n        short_description=\"\",\n        incident_time={\"opened\": str_time_now},\n        tlp=random.choice(mxdr_options.get(\"tlp\")),\n        confidence=random.choice(mxdr_options.get(\"confidence\")),\n        severity=random.choice(mxdr_options.get(\"severity\")),\n        schema_version=\"1.3.7\",\n        tactics=random.sample(mxdr_options.get(\"tactics\"), 2),\n        techniques=random.sample(mxdr_options.get(\"techniques\"), 3)\n    )\n\n    xdr_sighting = XDR_Sighting(\n        title=sighting_entry.get(\"title\", \"\"),\n        description=sighting_entry.get(\"description\", \"\"),\n        source=random.choice(mxdr_options.get(\"source\")),\n        observables=random.sample(mxdr_options.get(\"observables\", []), 3),\n        targets=[target_selection],\n        observed_time={\"start_time\": str_time_now},\n        external_ids=[],\n        tlp=random.choice(mxdr_options.get(\"tlp\")),\n        confidence=random.choice(mxdr_options.get(\"confidence\")),\n        severity=random.choice(mxdr_options.get(\"severity\")),\n    )\n\n    xdr_relationship = XDR_Relationship(\n        title=\"\",\n        description=\"\",\n        source=random.choice(mxdr_options.get(\"source\")),\n        external_ids=[],\n        source_ref=xdr_sighting.id,\n        target_ref=xdr_incident.id,\n        relationship_type=\"member-of\",\n        timestamp=str_time_now\n    )\n\n    xdr_bundle = XDR_Bundle(\n        source=source_selection,\n        incidents=[xdr_incident],\n        sightings=[xdr_sighting],\n        relationships=[xdr_relationship]\n    )\n\n    xdr_bundle_json = json.dumps(xdr_bundle.to_json())\n    print(xdr_bundle_json)\n\n    globals().update({\"xdr_bundle_json\": xdr_bundle_json})\n\nif __name__ == \"__console__\":\n    mxdr_options = json.loads(sys.argv[1])\n    main(mxdr_options=mxdr_options)\n\n\nif __name__ == \"__main__\":\n    mxdr_options = {}\n    with open('/Users/keperkin/Downloads/MXDR_Generator.json') as mxdr_file:\n        mxdr_options = json.load(mxdr_file)\n    main(mxdr_options=mxdr_options)",
                  "script_arguments": [
                    "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.static.variable_workflow_0284V2TH821JX65LNqd1dSLJPukjEJccEcx$"
                  ],
                  "script_queries": [
                    {
                      "script_query": "xdr_bundle_json",
                      "script_query_name": "xdr_bundle_json",
                      "script_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_0281E6YZJ3QYC2UXjeHfUEeiSf7X5flXOTg",
                "name": "HTTP Request",
                "title": "Post Incident Bundle",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "body": "$activity.definition_activity_0281E6YRHCL265tycVSGW4Yloz6yyiPHdew.output.script_queries.xdr_bundle_json$",
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": true,
                  "display_name": "Post Incident Bundle",
                  "method": "POST",
                  "relative_url": "/private-intel/bundle/import?external-key-prefixes=xdrauto",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "$module_target;Cisco XDR;securex:ao:iroh_api;platform-apis$"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_0284VG70EGT1L0zLq9EebrcCciCjZe80aYQ",
                "name": "Set Variables",
                "title": "Increment Counter",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Increment Counter",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.local.variable_workflow_0284VFW8EF7D20XxyzK5UyQCzh1r8tBdSvv$",
                      "variable_value_new": "$workflow.definition_workflow_0281E6YM8X7MR0v5DEJ3BTx8aV9VsY5Qu8h.local.variable_workflow_0284VFW8EF7D20XxyzK5UyQCzh1r8tBdSvv$+1"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_02JGJ1B20PTGB3vXZAUaOWVEM7XZZj7QV9M"
    ]
  },
  "categories": {
    "category_02JGJ1B20PTGB3vXZAUaOWVEM7XZZj7QV9M": {
      "unique_name": "category_02JGJ1B20PTGB3vXZAUaOWVEM7XZZj7QV9M",
      "name": "CLEUR25",
      "title": "CLEUR25",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "module_targets": [
    {
      "module_type": "Cisco XDR",
      "external_id": "securex:ao:iroh_api",
      "proxy_endpoint_metadata_id": "platform-apis"
    }
  ]
}